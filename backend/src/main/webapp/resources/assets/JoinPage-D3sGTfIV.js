import{a as U,u as w,r as h,b as c,c as D,d as x,e,f as n,w as u,n as A,t as E,v as d,g as I,h as T,o as q}from"./index-C9_JT14o.js";const m=U.create({timeout:1e3});m.interceptors.request.use(a=>{const{getToken:r}=w(),o=r();return o&&(a.headers.Authorization=`Bearer ${o}`,console.log(a.headers.Authorization)),a},a=>Promise.reject(a));m.interceptors.response.use(a=>a.status===200?a:a.status===404?Promise.reject("404: 페이지 없음 "+a.request):a,async a=>{var r;if(((r=a.response)==null?void 0:r.status)===401){const{logout:o}=w();return o(),h.push("/auth/login?error=login_required"),Promise.reject({error:"로그인이 필요한 서비스입니다."})}return Promise.reject(a)});const v="/api/member",S={"Content-Type":"multipart/form-data"},b={async checkUsername(a){const{data:r}=await m.get(`${v}/checkusername/${a}`);return console.log("AUTH GET CHECKUSERNAME",r),r},async create(a){const r=new FormData;r.append("username",a.username),r.append("email",a.email),r.append("password",a.password),a.avatar&&r.append("avatar",a.avatar);const{data:o}=await m.post(v,r,S);return console.log("AUTH POST:",o),o}},j={class:"mt-5 mx-auto",style:{width:"500px"}},P={class:"mb-3 mt-3"},V={for:"username",class:"form-label"},B={class:"mb-3 mt-3"},C={class:"mb-3"},z={class:"mb-3"},H=["disabled"],N={__name:"JoinPage",setup(a){const r=T(),o=c(null),p=c(""),i=c(!0),t=D({username:"",email:"",password:"",password2:"",avatar:null}),y=async()=>{if(!t.username)return alert("사용자 ID를 입력하세요.");i.value=await b.checkUsername(t.username),p.value=i.value?"이미 사용중인 ID입니다.":"사용 가능한 ID입니다."},g=()=>{i.value=!0,p.value=t.username?"ID 중복 체크를 하셔야 합니다.":""},k=async()=>{if(t.email.trim()==="")return alert("이메일을 입력해주세요");if(t.password!=t.password2)return alert("비밀번호가 일치하지 않습니다.");o.value.files.length>0&&(t.avatar=o.value.files[0]);try{await b.create(t),alert("가입 성공!"),r.push({name:"login"})}catch(f){console.error(f)}};return(f,s)=>(q(),x("div",j,[s[11]||(s[11]=e("h1",{class:"my-5"},[e("i",{class:"fa-solid fa-user-plus"}),n(" 회원 가입 ")],-1)),e("form",{onSubmit:I(k,["prevent"])},[e("div",P,[e("label",V,[s[4]||(s[4]=e("i",{class:"fa-solid fa-user"},null,-1)),s[5]||(s[5]=n(" 사용자 ID : ")),e("button",{type:"button",class:"btn btn-success btn-sm py-0 me-2",onClick:y}," ID 중복 확인 "),e("span",{class:A(i.value?"text-danger":"text-primary")},E(p.value),3)]),u(e("input",{type:"text",class:"form-control",placeholder:"사용자 ID",id:"username",onInput:g,"onUpdate:modelValue":s[0]||(s[0]=l=>t.username=l),required:""},null,544),[[d,t.username]])]),e("div",null,[s[6]||(s[6]=e("label",{for:"avatar",class:"form-label"},[e("i",{class:"fa-solid fa-user-astronaut"}),n(" 아바타 이미지: ")],-1)),e("input",{type:"file",class:"form-control",ref_key:"avatar",ref:o,id:"avatar",accept:"image/png, image/jpeg"},null,512)]),e("div",B,[s[7]||(s[7]=e("label",{for:"email",class:"form-label"},[e("i",{class:"fa-solid fa-envelope"}),n(" email ")],-1)),u(e("input",{type:"email",class:"form-control",placeholder:"Email",id:"email","onUpdate:modelValue":s[1]||(s[1]=l=>t.email=l),required:""},null,512),[[d,t.email]])]),e("div",C,[s[8]||(s[8]=e("label",{for:"password",class:"form-label"},[e("i",{class:"fa-solid fa-lock"}),n(" 비밀번호: ")],-1)),u(e("input",{type:"password",class:"form-control",placeholder:"비밀번호",id:"password","onUpdate:modelValue":s[2]||(s[2]=l=>t.password=l),required:""},null,512),[[d,t.password]])]),e("div",z,[s[9]||(s[9]=e("label",{for:"password",class:"form-label"},[e("i",{class:"fa-solid fa-lock"}),n(" 비밀번호 확인: ")],-1)),u(e("input",{type:"password",class:"form-control",placeholder:"비밀번호 확인",id:"password2","onUpdate:modelValue":s[3]||(s[3]=l=>t.password2=l),required:""},null,512),[[d,t.password2]])]),e("button",{type:"submit",class:"btn btn-primary mt-4",disabled:i.value},s[10]||(s[10]=[e("i",{class:"fa-solid fa-user-plus"},null,-1),n(" 확인 ")]),8,H)],32)]))}};export{N as default};
